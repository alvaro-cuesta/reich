webpackJsonp([1],{173:function(e,t,n){e.exports=n(174)},174:function(e,t,n){"use strict";e.exports=n(175)},175:function(e,t,n){"use strict";e.exports.AppContainer=n(176)},176:function(e,t,n){"use strict";e.exports=n(177)},177:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(17),s=i.Component;e.exports=function(e){function t(){return a(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,e),o(t,[{key:"render",value:function(){return this.props.component?i.createElement(this.props.component,this.props.props):i.Children.only(this.props.children)}}]),t}(s)},178:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){var n={};for(var a in e)t.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a]);return n}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n(17),h=a(u),p=n(47),f=(a(p),n(48)),d=(a(f),n(180)),m=a(d),v=[!0,!0,!0,!1,!0,!0,!1,!0,!1,!0,!0,!1],y=440,g=230,b=1780,w=[90],P=[77],S=function(e,t,n){var a=localStorage.getItem(e);return null!==a?t(a):n},E=function(e){var t=e.label,n=s(e,["label"]);return h.default.createElement("label",null,"checkbox"!==n.type?h.default.createElement("span",{className:"label noselect"},t):null,h.default.createElement("input",n),"checkbox"===n.type?h.default.createElement("span",{className:"label noselect"},t):null)},k=function(){function e(t,n){i(this,e),this.f=n,this.context=t,this.oscillator=t.createOscillator(),this.oscillator.type="square",this.oscillator.frequency.value=n,this.gain=t.createGain(),this.gain.gain.value=0,this.oscillator.start(),this.oscillator.connect(this.gain),this.gain.connect(t.destination)}return c(e,[{key:"schedule",value:function(e,t,n){this.gain.gain.setValueAtTime(e,t),this.gain.gain.setValueAtTime(0,n)}},{key:"scheduleFrequency",value:function(e,t){this.oscillator.frequency.setValueAtTime(e,t)}},{key:"cancelScheduledValues",value:function(){var e=this.context.currentTime;this.oscillator.frequency.cancelScheduledValues(e),this.gain.gain.cancelScheduledValues(e),this.gain.gain.value=0,this.oscillator.frequency.value=this.f}},{key:"disconnect",value:function(){this.gain.disconnect(),this.oscillator.disconnect()}}]),e}(),_=function(e){return"true"===e},O=function(e){function t(e){i(this,t);var n=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),a=e.context;return n.clap1=new k(a,y),n.clap2=new k(a,g),n.metronome=new k(a,b),n.handleKeyDown=n.handleKeyDown.bind(n),n.handleSound=n.handleSound.bind(n),n.handleStart=n.handleStart.bind(n),n.handleStop=n.handleStop.bind(n),n.handleSetting=n.handleSetting.bind(n),n.state={tempo:S("tempo",parseInt,120),repeats:S("repeats",parseInt,4),swing:S("swing",parseFloat,.5),clap1:S("clap1",_,!0),clap2:S("clap2",_,!0),metronome:S("metronome",_,!1),countMetronome:S("countMetronome",_,!0),startTime:!1,now:!1,userInput:!1},n}return o(t,e),c(t,[{key:"componentWillMount",value:function(){window.addEventListener("keydown",this.handleKeyDown,!1)}},{key:"componentWillUnmount",value:function(){this.handleStop(),this.clap1.disconnect(),this.clap2.disconnect(),this.metronome.disconnect(),window.removeEventListener("keydown",this.handleKeyDown,!1)}},{key:"handleKeyDown",value:function(e){var t=e.repeat,n=e.key,a=e.keyCode,r=e.timeStamp;if(!t){var l=this.state.userInput,o=this.getPosition(),i=o.pattern,s=o.pulse,c=this.getPulseDiff(performance.now()-r),u=c.currPulseDiff,h=c.nextPulseDiff;w.includes(a)?(console.log("clap1",u,h),void 0===l[i]&&(l[i]=[]),u<h?l[i][s]=u:(s+=1,s===v.length&&(s=0,i+=1,void 0===l[i]&&(l[i]=[])),l[i][s]=h),this.setState({userInput:l})):P.includes(a)?console.log("clap2",u,h):console.log(n,a)}}},{key:"handleSetting",value:function(e,t){var n=this;return void 0===t&&(t=function(e){return e}),function(a){var l=a.target,o=l.type,i=l.value,s=l.checked;"checkbox"===o?(localStorage.setItem(e,s),n.setState(r({},""+e,t(s)))):(localStorage.setItem(e,i),n.setState(r({},""+e,t(i))))}}},{key:"handleStart",value:function(e){var t=this,n=e.timeStamp,a=this.props.context,r=this.state.countMetronome,l=a.currentTime;this.clap1.cancelScheduledValues(),this.clap2.cancelScheduledValues(),this.metronome.cancelScheduledValues(),this.performanceNow=performance.now(),this.timeStamp=n,this.lastPulse=!1,this.setState({startTime:l+this.getSecsPerBeat()/2*v.length,now:l,userInput:[]}),r&&this.metronome.schedule(1,l,l+.0125),this.timeInterval=setInterval(function(){t.setState({now:a.currentTime},t.handleSound)},1)}},{key:"handleStop",value:function(){clearInterval(this.timeInterval),this.clap1.cancelScheduledValues(),this.clap2.cancelScheduledValues(),this.metronome.cancelScheduledValues(),this.setState({startTime:!1,now:!1})}},{key:"handleSound",value:function(){var e=this.state.repeats,t=this.getPosition(),n=t.pattern,a=t.pulse,r=t.totalPulses;if(n>=(v.length+1)*e)return void this.handleStop();if(!1===this.lastPulse)this.lastPulse=0;else{if(a===this.lastPulse)return;this.lastPulse=a}a+=1,r+=1,a===v.length&&(a=0,n+=1),n>=(v.length+1)*e||this.schedulePulseSound(a,n,r)}},{key:"schedulePulseSound",value:function(e,t,n){var a=this.state,r=a.clap1,l=a.clap2,o=a.metronome,i=a.countMetronome,s=a.repeats,c=this.getPulseStart(n),u=c+.0125,h=0===e?1:.25;if(t>=0){r&&v[e%v.length]&&this.clap1.schedule(h,c,u);var p=Math.floor(t/s);l&&v[(p+e)%v.length]&&this.clap2.schedule(h,c,u)}var f=o&&t>=0&&e%2==0,d=i&&-1===t&&e%2==0;(f||d)&&(this.metronome.scheduleFrequency(0===e?b:890,c),this.metronome.schedule(h,c,u))}},{key:"getSecsPerBeat",value:function(){return 60/this.state.tempo}},{key:"getPosition",value:function(){var e=this.state,t=e.swing,n=e.startTime,a=e.now;if(!1===n)return{};var r=(a-n)/this.getSecsPerBeat(),l=2*Math.floor(r)+((1+r%1)%1<t?0:1);if(n>=a){for(var o=l;o<0;)o+=v.length;return{pattern:Math.floor(l/v.length),pulse:o,totalPulses:l}}return{pattern:Math.floor(l/v.length),pulse:l%v.length,totalPulses:l}}},{key:"getPulseDiff",value:function(e){var t=this.props.context,n=this.state.swing,a=this.getPosition(),r=a.totalPulses,l=t.currentTime-e/1e3,o=this.getSecsPerBeat();return{currPulseDiff:(l-this.getPulseStart(r))/(o*n),nextPulseDiff:(this.getPulseStart(r+1)-l)/(o*(1-n))}}},{key:"getPulseStart",value:function(e){var t=this.state,n=t.startTime,a=t.swing;return n+(Math.floor(e/2)+(e%2==0?0:a))*this.getSecsPerBeat()}},{key:"render",value:function(){var e=this.state,t=e.tempo,n=e.repeats,a=e.swing,r=e.clap1,l=e.clap2,o=e.metronome,i=e.countMetronome,s=e.userInput,c=this.getPosition(),u=c.pattern,p=c.pulse,f=void 0,d=void 0;return void 0===u?(f=this.handleStart,d="Start"):u<0?(f=this.handleStop,d=Math.floor(p/2)+1):(f=this.handleStop,d="Stop"),h.default.createElement("div",{className:"reich-app"},h.default.createElement("div",{className:"controls"},h.default.createElement("fieldset",{className:"tempo"},h.default.createElement(E,{label:"Tempo:",type:"number",min:1,max:999,step:1,value:t,onChange:this.handleSetting("tempo",parseInt)}),h.default.createElement(E,{label:"Repeats:",type:"number",min:1,max:999,step:1,value:n,onChange:this.handleSetting("repeats",parseInt)}),h.default.createElement(E,{label:"Swing:",type:"number",min:.1,max:.9,step:.01,value:a,onChange:this.handleSetting("swing",parseFloat)})),h.default.createElement("fieldset",null,h.default.createElement("div",{className:"noselect"},"Sounds:"),h.default.createElement(E,{label:"Clap 1",type:"checkbox",checked:r,onChange:this.handleSetting("clap1")}),h.default.createElement(E,{label:"Clap 2",type:"checkbox",checked:l,onChange:this.handleSetting("clap2")}),h.default.createElement(E,{label:"Metronome",type:"checkbox",checked:o,onChange:this.handleSetting("metronome")}),h.default.createElement(E,{label:"Count",type:"checkbox",checked:i,onChange:this.handleSetting("countMetronome")}))),h.default.createElement(m.default,{buttonHandler:f,buttonLabel:d,clapPattern:v,pattern:u,pulse:p,repeats:n,userInput:s}))}}]),t}(h.default.PureComponent);t.default=O,O.propTypes={}},180:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),s=n(17),c=a(s),u=n(29),h=a(u),p=n(47),f=(a(p),n(48)),d=(a(f),function(e,t,n,a){return n*Math.sin(e/a*(Math.PI/2))+t}),m=function(e,t,n,a){var r=e.scrollTop,l=t-e.scrollTop,o=performance.now(),i=function i(){var s=performance.now()-o;if(s>n)return void(e.scrollTop=t);e.scrollTop=a(s,r,l,n),requestAnimationFrame(i)};requestAnimationFrame(i)},v=d,y=function(e){function t(){return r(this,t),l(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),i(t,[{key:"render",value:function(){var e=this.props,t=e.clapPattern,n=e.head,a=e.shift,r=e.highlightPulse,l=e.currentPattern,o=e.donePattern,i=e.userInput;return c.default.createElement("div",{className:"clap-row "+e.className},c.default.createElement("div",{className:"head"},n),c.default.createElement("div",{className:"pattern"},t.map(function(e,n){var s=(n+a)%t.length,u=t[s],h="cell pulse "+(u?"clap":"silence")+" "+(n===r?"highlight":"")+" ",p=void 0===i||void 0===i[n],f=p?"no-hit":i[n]>2/3?"hit-bad":i[n]>1/3?"hit-ok":"hit-good";return l?(n<r||n===r&&!p)&&(h+=f):(o||void 0!==i)&&(h+=f),c.default.createElement("div",{key:n,className:h})})))}}]),t}(c.default.PureComponent);y.defaultProps={head:"",shift:0,className:""};var g=function(e){function t(e){r(this,t);var n=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.rows=[],n}return o(t,e),i(t,[{key:"componentDidMount",value:function(){this.scrollAnchor.scrollTop=this.rows[0]-this.scrollAnchor.offsetTop+this.rows[0].offsetHeight-4}},{key:"componentWillReceiveProps",value:function(e){var t=e.pattern;this.props.pattern!==t&&((void 0===t||t<=0)&&(t=0),this.scrollToPattern(t))}},{key:"scrollToPattern",value:function(e){m(document.scrollingElement,this.rows[e].offsetTop-this.scrollAnchor.offsetTop+this.rows[e].offsetHeight-4,300,v)}},{key:"render",value:function(){var e=this,t=this.props,n=t.buttonHandler,a=t.buttonLabel,r=t.clapPattern,l=t.pattern,o=t.pulse,i=t.repeats,s=t.userInput,u=t.className,p=l;return(void 0===l||l<=0)&&(l=0),c.default.createElement("div",{className:"pattern-table noselect "+u,ref:function(t){return e.scrollAnchor=h.default.findDOMNode(t)}},c.default.createElement("div",{className:"arrow-row"},c.default.createElement("div",{className:"head"},c.default.createElement("button",{className:"noselect",onClick:n},a)),c.default.createElement("div",{className:"pattern"},r.map(function(e,t){return c.default.createElement("div",{key:t,className:"cell arrow"},p>=-1&&t===o?"▼":"")}))),c.default.createElement("div",{className:"pattern-clap1"},c.default.createElement(y,{clapPattern:r,head:"Clap 1 ➡",shift:0,highlightPulse:o})),c.default.createElement("div",{className:"pattern-clap2"},Array.apply(null,{length:1}).map(function(t,n){return c.default.createElement(y,{key:n,ref:function(t){return e.rows[n]=h.default.findDOMNode(t)},clapPattern:r,className:"empty"})}),Array.apply(null,{length:(r.length+1)*i}).map(function(t,n){return c.default.createElement(y,{key:n,ref:function(t){return e.rows[n+1]=h.default.findDOMNode(t)},clapPattern:r,className:n===l?"highlight":"",highlightPulse:n===l?o:void 0,head:n===l?"Clap 2 ➡":"",shift:Math.floor(n/i),userInput:s[n],donePattern:n<p,currentPattern:n===p})}),c.default.createElement("div",{className:"padder"},c.default.createElement("div",{className:"head"}),c.default.createElement("div",{className:"pattern empty"},r.map(function(e,t){return c.default.createElement("div",{key:t,className:"cell pulse"})})))))}}]),t}(c.default.PureComponent);t.default=g,g.defaultProps={className:""}},181:function(){},81:function(e,t,n){e.exports=n(82)},82:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var r=n(17),l=a(r),o=n(29),i=a(o),s=n(173),c=n(178),u=a(c);n(181);var h=new AudioContext;i.default.render(l.default.createElement(s.AppContainer,null,l.default.createElement(u.default,{context:h})),document.getElementById("container"))}},[81]);
//# sourceMappingURL=reich.60ff185223dc1c9c3165.js.map